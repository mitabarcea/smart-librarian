<!doctype html><html><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="stylesheet" href="auth.css">
<title>Change password â€¢ Smart Librarian</title>
</head><body>
<div class="container">
  <div class="card">
    <h1>Change password</h1>
    <div id="msg" class="alert" style="display:none"></div>

    <div class="row"><button id="btnSend">Send confirmation code</button></div>
    <div class="sp"></div>
    <label>6-digit code</label>
    <input id="code" placeholder="123456" inputmode="numeric" maxlength="6">
    <label>Current password</label>
    <input id="cur" type="password">
    <label>New password</label>
    <input id="newpw" type="password">
    <div class="row"><button id="btnConfirm">Change password</button></div>
    <p class="note center"><a class="link" href="index.html">Back</a></p>
  </div>
</div>

<script src="auth.js"></script>
<script>
const msg = document.getElementById('msg');
btnSend.onclick = async ()=>{
  hide(msg);
  try{ await post('/auth/change-password/request', {}, true); show(msg,'Code sent to your email.', true) }
  catch(e){ show(msg,e,false) }
};
btnConfirm.onclick = async ()=>{
  hide(msg);
  const code = codeEl.value.trim(), current_password=curEl.value, new_password=newEl.value;
  try{ await post('/auth/change-password/confirm', {code,current_password,new_password}, true); show(msg,'Password changed.', true) }
  catch(e){ show(msg,e,false) }
};
const codeEl=document.getElementById('code'), curEl=document.getElementById('cur'), newEl=document.getElementById('newpw');
const btnSend=document.getElementById('btnSend'), btnConfirm=document.getElementById('btnConfirm');
</script>
</body></html>
